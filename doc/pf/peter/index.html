<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Firewalling with OpenBSD's PF packet filter
  </TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="NEXT"
TITLE="Before we start"
HREF="preface.html"><META
NAME="KEYWORD"
CONTENT="firewall"><META
NAME="KEYWORD"
CONTENT="firewalls"><META
NAME="KEYWORD"
CONTENT="firewalling"><META
NAME="KEYWORD"
CONTENT="OpenBSD"><META
NAME="KEYWORD"
CONTENT="OpenBSD PF"><META
NAME="KEYWORD"
CONTENT="OpenBSD packet filter"><META
NAME="KEYWORD"
CONTENT="OpenBSD firewall"><META
NAME="KEYWORD"
CONTENT="OpenBSD firewalling"><META
NAME="KEYWORD"
CONTENT="OpenBSD firewalling tutorial"><META
NAME="KEYWORD"
CONTENT="BSD firewalling tutorial"><META
NAME="KEYWORD"
CONTENT="firewalling tutorial"><META
NAME="KEYWORD"
CONTENT="OpenBSD packet filter tutorial"><META
NAME="KEYWORD"
CONTENT="OpenBSD PF tutorial"><META
NAME="KEYWORD"
CONTENT="FreeBSD PF tutorial"><META
NAME="KEYWORD"
CONTENT="NetBSD PF tutorial"><META
NAME="KEYWORD"
CONTENT="FreeBSD"><META
NAME="KEYWORD"
CONTENT="FreeBSD PF"><META
NAME="KEYWORD"
CONTENT="FreeBSD firewall"><META
NAME="KEYWORD"
CONTENT="FreeBSD firewalling"><META
NAME="KEYWORD"
CONTENT="NetBSD"><META
NAME="KEYWORD"
CONTENT="NetBSD firewall"><META
NAME="KEYWORD"
CONTENT="NetBSD firewalling"><META
NAME="KEYWORD"
CONTENT="firewalling"><META
NAME="KEYWORD"
CONTENT="packet filter"><META
NAME="KEYWORD"
CONTENT="packet filter tutorial"><META
NAME="KEYWORD"
CONTENT="PF"><META
NAME="KEYWORD"
CONTENT="PF tutorial"><META
NAME="KEYWORD"
CONTENT="network"><META
NAME="KEYWORD"
CONTENT="networking"><META
NAME="KEYWORD"
CONTENT="network firewall"><META
NAME="KEYWORD"
CONTENT="network firewalling"><META
NAME="KEYWORD"
CONTENT="network security"><META
NAME="KEYWORD"
CONTENT="internet firewall"><META
NAME="KEYWORD"
CONTENT="internet protocol"><META
NAME="KEYWORD"
CONTENT="internet security"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="docbook.css"><meta
http-equiv="Content-Type"
content="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="BOOK"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="BOOK"
><A
NAME="AEN1"
></A
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
><A
NAME="AEN2"
>Firewalling with OpenBSD's PF packet filter</A
></H1
><H3
CLASS="AUTHOR"
><A
NAME="AEN40"
></A
>Peter N. M. Hansteen</H3
><DIV
CLASS="AFFILIATION"
><DIV
CLASS="ADDRESS"
><P
CLASS="ADDRESS"
><CODE
CLASS="EMAIL"
>&#60;<A
HREF="mailto:peter@bsdly.net"
>peter@bsdly.net</A
>&#62;</CODE
></P
></DIV
></DIV
><P
CLASS="COPYRIGHT"
><A
HREF="legalnotice.html"
>Copyright</A
> &copy; 2005 - 2017 Peter N. M. Hansteen</P
><HR></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
><A
HREF="preface.html"
>Before we start</A
></DT
><DT
><A
HREF="intro.html"
>PF?</A
></DT
><DT
><A
HREF="concepts.html"
>Packet filter? Firewall?</A
></DT
><DT
><A
HREF="nat.html"
>NAT?</A
></DT
><DT
><A
HREF="pftoday.html"
>PF today</A
></DT
><DT
><A
HREF="bsdvslinux.html"
>BSD vs Linux - Configuration</A
></DT
><DT
><A
HREF="simplestconfig.html"
>Simplest possible setup (OpenBSD)</A
></DT
><DT
><A
HREF="simplestfreebsd.html"
>Simplest possible setup (FreeBSD)</A
></DT
><DT
><A
HREF="netbsdbasics.html"
>Simplest possible setup (NetBSD)</A
></DT
><DT
><A
HREF="minimal-ruleset.html"
>First rule set - single machine</A
></DT
><DT
><A
HREF="stricter.html"
>Slightly stricter</A
></DT
><DT
><A
HREF="pfctlstats.html"
>Statistics from <SPAN
CLASS="APPLICATION"
>pfctl</SPAN
></A
></DT
><DT
><A
HREF="basicgw.html"
>A simple gateway, NAT if you need it</A
></DT
><DD
><DL
><DT
><A
HREF="basicgw.html#GWPITFALLS"
>Gateways and the pitfalls of in, out and on</A
></DT
><DT
><A
HREF="whatsyourlocalnet.html"
>What is your local network, anyway?</A
></DT
><DT
><A
HREF="gwsimplesetup.html"
>Setting up</A
></DT
></DL
></DD
><DT
><A
HREF="ftpproblem.html"
>That sad old FTP thing</A
></DT
><DD
><DL
><DT
><A
HREF="ftpproblem.html#FRESH-FTP-PROXY"
>If We Have To: ftp-proxy With Divert or Redirection</A
></DT
><DT
><A
HREF="historical-deprecated.html"
>Historical FTP proxies: do not use</A
></DT
><DD
><DL
><DT
><A
HREF="historical-deprecated.html#FTP-PROXY"
>Ancient FTP through NAT: <SPAN
CLASS="APPLICATION"
>ftp-proxy</SPAN
></A
></DT
><DT
><A
HREF="historical-deprecated.html#FTPSESAME"
>Ancient: FTP, PF and routable addresses: <SPAN
CLASS="APPLICATION"
>ftpsesame</SPAN
>, <SPAN
CLASS="APPLICATION"
>pftpx</SPAN
> and <SPAN
CLASS="APPLICATION"
>ftp-proxy</SPAN
>!</A
></DT
><DT
><A
HREF="historical-deprecated.html#NEWFTPPROXY"
><SPAN
CLASS="APPLICATION"
>ftp-proxy</SPAN
>, slightly new style</A
></DT
></DL
></DD
></DL
></DD
><DT
><A
HREF="troubleshoot.html"
>Making your network troubleshooting friendly</A
></DT
><DD
><DL
><DT
><A
HREF="troubleshoot.html#DOWEPASS"
>Then, do we let it all through?</A
></DT
><DT
><A
HREF="icmpstopatgw.html"
>The easy way out: The buck stops here</A
></DT
><DT
><A
HREF="letpingthru.html"
>Letting <SPAN
CLASS="APPLICATION"
>ping</SPAN
> through</A
></DT
><DT
><A
HREF="helptraceroute.html"
>Helping <SPAN
CLASS="APPLICATION"
>traceroute</SPAN
></A
></DT
><DT
><A
HREF="pathmtudisc.html"
>Path MTU discovery</A
></DT
></DL
></DD
><DT
><A
HREF="hygiene.html"
>Network hygiene: Blocking, scrubbing and so on</A
></DT
><DD
><DL
><DT
><A
HREF="hygiene.html#BLOCKPOLICY"
><KBD
CLASS="USERINPUT"
>block-policy</KBD
></A
></DT
><DT
><A
HREF="scrub.html"
><KBD
CLASS="USERINPUT"
>scrub</KBD
></A
></DT
><DT
><A
HREF="antispoof.html"
><KBD
CLASS="USERINPUT"
>antispoof</KBD
></A
></DT
><DT
><A
HREF="unrouteables.html"
>Handling non-routable addresses from elsewhere</A
></DT
></DL
></DD
><DT
><A
HREF="rdr2servers.html"
>A web server and a mail server on the inside</A
></DT
><DD
><DL
><DT
><A
HREF="rdr2servers.html#RDRFROMINSIDE"
>Taking care of your own - the inside</A
></DT
></DL
></DD
><DT
><A
HREF="tables.html"
>Tables make your life easier</A
></DT
><DT
><A
HREF="logging.html"
>Logging</A
></DT
><DD
><DL
><DT
><A
HREF="logging.html#TCPDUMPEX"
>Taking a peek with <SPAN
CLASS="APPLICATION"
>tcpdump</SPAN
></A
></DT
><DT
><A
HREF="otherlogtools.html"
>Other log tools you may want to look into</A
></DT
><DT
><A
HREF="logsizes.html"
>But there are limits (an anecdote)</A
></DT
></DL
></DD
><DT
><A
HREF="systat-states.html"
>Keeping an eye on things with systat</A
></DT
><DT
><A
HREF="pftop.html"
>Keeping an eye on things with pftop</A
></DT
><DT
><A
HREF="bridge.html"
>Invisible gateway - bridge</A
></DT
><DT
><A
HREF="altqintro.html"
>Directing traffic with ALTQ</A
></DT
><DD
><DL
><DT
><A
HREF="altqintro.html#ALTQACKPRI"
>ALTQ - prioritizing by traffic type</A
></DT
><DD
><DL
><DT
><A
HREF="altqintro.html#ALTQACKPRI.TOS"
>So why does this work?</A
></DT
><DT
><A
HREF="altqintro.html#MATCHQUEUEASSIGN"
>Using a match Rule for Queue Assignment</A
></DT
></DL
></DD
><DT
><A
HREF="altqbypct.html"
>ALTQ - allocation by percentage</A
></DT
><DT
><A
HREF="altqsmtp.html"
>ALTQ - handling unwanted traffic</A
></DT
></DL
></DD
><DT
><A
HREF="carp.html"
>CARP and pfsync</A
></DT
><DT
><A
HREF="wireless.simple.html"
>Wireless networks made simple</A
></DT
><DD
><DL
><DT
><A
HREF="wireless.simple.html#WIFIBACKGROUND"
>A little IEEE 802.11 background</A
></DT
><DD
><DL
><DT
><A
HREF="wireless.simple.html#WEP"
>WEP (Wired Equivalent Privacy)</A
></DT
><DT
><A
HREF="wireless.simple.html#WPA"
>WPA (WiFi Protected Access)</A
></DT
></DL
></DD
><DT
><A
HREF="wireless.simple.setup.html"
>Setting up a simple wireless network</A
></DT
></DL
></DD
><DT
><A
HREF="vegard.authpf.html"
>An open, yet tightly guarded wireless network with <SPAN
CLASS="APPLICATION"
>authpf</SPAN
></A
></DT
><DT
><A
HREF="bruteforce.html"
>Turning away the brutes</A
></DT
><DD
><DL
><DT
><A
HREF="bruteforce.html#EXPIRE"
>expiring table entries with <SPAN
CLASS="APPLICATION"
>pfctl</SPAN
></A
></DT
><DT
><A
HREF="expiretable.html"
>Using <SPAN
CLASS="APPLICATION"
>expiretable</SPAN
> to tidy your tables</A
></DT
></DL
></DD
><DT
><A
HREF="spamd.html"
>Giving spammers a hard time</A
></DT
><DD
><DL
><DT
><A
HREF="spamd.html#SPAMD.NOTALONE"
>Remember, you are not alone: blacklisting</A
></DT
><DT
><A
HREF="spamd.tarandgrey.html"
>List of black and grey, and the sticky tarpit</A
></DT
><DT
><A
HREF="spamd.setup.html"
>Setting up <SPAN
CLASS="APPLICATION"
>spamd</SPAN
></A
></DT
><DT
><A
HREF="spamd.experience.html"
>Some early highlights of our <SPAN
CLASS="APPLICATION"
>spamd</SPAN
> experience</A
></DT
><DT
><A
HREF="spamd.greytrapping.html"
>Beating'em up some more: <SPAN
CLASS="APPLICATION"
>spamdb</SPAN
> and greytrapping</A
></DT
><DD
><DL
><DT
><A
HREF="spamd.greytrapping.html#SPAMD.GREYTRAPPING.WHY"
>Enter greytrapping</A
></DT
><DT
><A
HREF="spamd.greytrapping.html#SPAMD.GREYTRAPPING.HOW"
>Your own traplist</A
></DT
><DT
><A
HREF="spamd.greytrapping.html#SPAMD.GREYTRAPPING.MISC"
>Deleting, handling trapped entries</A
></DT
><DT
><A
HREF="spamd.greytrapping.html#DOWNSIDE-WHITELISTING"
>The downside: some people really do not get it</A
></DT
></DL
></DD
><DT
><A
HREF="spamd.conclusion.html"
>Conclusions from our <SPAN
CLASS="APPLICATION"
>spamd</SPAN
> experience</A
></DT
></DL
></DD
><DT
><A
HREF="pfhaiku.html"
>PF - Haiku</A
></DT
><DT
><A
HREF="references.html"
>References</A
></DT
><DT
><A
HREF="webhome.html"
>Where to find the tutorial on the web</A
></DT
><DD
><DL
><DT
><A
HREF="webhome.html#SUPPPORTTHEPROJECT"
>If you enjoyed this: Buy OpenBSD CDs and other items, donate!</A
></DT
></DL
></DD
></DL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="preface.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Before we start</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>